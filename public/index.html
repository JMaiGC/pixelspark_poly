<!DOCTYPE html>

<html>
  <head>
    <title>LLMD client</title>
  </head>

  <body>
    <input id="prompt" placeholder="Prompt..." onkeyup="promptKeyup(event)" />

    <textarea id="results" readonly disabled></textarea>

    <script>
      const server = "http://localhost:3000";
      const maxTokens = 50;

      let eventSource = null;

      function promptKeyup(e) {
        if (e.keyCode === 13) {
          // Enter key pressed

          const prompt = document.getElementById("prompt").value;

          if (eventSource !== null) {
            eventSource.close();
            eventSource = null;
          }

          eventSource = new EventSource(
            server +
              "/model/rp/live?max_tokens=" +
              maxTokens +
              "&prompt=" +
              encodeURIComponent(prompt)
          );
          document.getElementById("results").value = "";

          eventSource.onmessage = function (e) {
            document.getElementById("results").value += e.data;
          };

          eventSource.onerror = function (e) {
            eventSource.close();
          };
        }
      }
    </script>

    <style type="text/css">
      * {
        box-sizing: border-box;
      }

      html,
      body {
        padding: 0;
        margin: 0;
      }

      body {
        width: 100%;
        height: 100%;
        display: flex;
        flex-direction: column;
      }

      textarea#results {
        height: 200px;
      }
    </style>
  </body>
</html>
